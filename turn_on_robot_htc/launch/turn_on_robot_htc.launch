<launch>

    <!-- 是否开启建图 -->
    <arg name="is_mapping" default="true" />
    <!-- 是否开启导航 -->
    <arg name="is_navigation" default="false" />

    <arg name="htc_car_mode" default="wheeltec_mini_akm" /> 
    <!-- 建图类型 -->
    <arg name="htc_mapping_mode" default="gmapping" doc="opt: gmapping,hector,cartographer,karto" />
    <!-- 激光雷达类型 -->
    <arg name="htc_lidar_mode" default="ls_N10P" />

    <!-- 导航算法 -->
    <arg name="htc_nav_mode" default="teb_local_planner" />

    <!-- 控制类型 -->
    <arg name="htc_cmd_mode" default="steering" doc="opt: steering" />
    
    <arg name="repeat"  default="false"/>

    <!-- 里程计 framd_id -->
    <arg name="odom_frame_id" default="odom_combined"/>

    <!-- cmd topic -->
    <arg name="htc_cmd_topic" default="/cmd_vel"/>

    <!-- 开启底层单片机控制节点 -->
    <include file="$(find turn_on_robot_htc)/launch/include/base_serial.launch" if="$(eval htc_car_mode == 'wheeltec_mini_akm')">
        <arg name="odom_frame_id"  value="$(arg odom_frame_id)"/>
    </include>

    <!-- 激光雷达控制节点 -->
    <include file="$(find turn_on_robot_htc)/launch/lidar_htc.launch">
        <arg name="htc_lidar_mode" value="$(arg htc_lidar_mode)"/>
    </include>

    <!-- TF & 小车模型 节点 -->
    <include file="$(find turn_on_robot_htc)/launch/robot_model_htc.launch">
        <arg name="htc_car_mode" value="$(arg htc_car_mode)"/>
    </include>

    <!-- 扩张卡尔曼滤波 发布odom_combined到footprint的TF,即小车定位 使用cartographer算法时不使用该滤波算法-->
    <include file="$(find turn_on_robot_htc)/launch/include/robot_pose_ekf.launch">
    </include>

    <!-- 建图控制节点 -->
    <include file="$(find turn_on_robot_htc)/launch/mapping_htc.launch" if="$(arg is_mapping)">
        <arg name="htc_mapping_mode" value="$(arg htc_mapping_mode)"/>
    </include>

    <!-- 导航控制节点 -->
    <include file="$(find turn_on_robot_htc)/launch/navigation_htc.launch" if="$(arg is_navigation)">
        <arg name="htc_car_mode" value="$(arg htc_car_mode)"/>
        <arg name="htc_nav_mode" value="$(arg htc_nav_mode)"/>
    </include>

    <!-- 车辆控制节点 -->
    <!-- TODO keyboard 需要打开新窗口 不会 -->
    <include file="$(find turn_on_robot_htc)/launch/robot_cmd_htc.launch">
        <arg name="htc_cmd_topic" value="$(arg htc_cmd_topic)" />
        <arg name="htc_cmd_mode" value="$(arg htc_cmd_mode)" />
    </include>

</launch>